<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Probe Similarity to Mean and All-Probe</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <style>
      body { font-family: 'Inter', sans-serif; background: #f9fafb; }
      .container { max-width: 1000px; margin: 40px auto; padding: 2.5rem; background: #fff; border-radius: 18px; box-shadow: 0 2px 12px rgba(0,0,0,0.07);}
    </style>
</head>
<body>

  <div class="mb-4">
      <a href="index.html" 
          class="inline-block px-4 py-2 rounded-xl bg-blue-600 text-white font-semibold shadow hover:bg-blue-700 transition-colors duration-150">
          ‚Üê Back to Index
      </a>
  </div>

  <div class="container">
    <h1 class="text-3xl font-bold text-gray-900 mb-4">Probe Similarity to Mean and "Single All" Probe</h1>
    <p class="text-gray-600 mb-6">Compare the cosine similarity of each probe to both the mean probe (across this dataset) and the probe trained on all binary classification datasets.</p>
    <div>
      <label for="dataset-select" class="block mb-2 text-sm font-medium text-gray-900">Select Dataset:</label>
      <select id="dataset-select" class="mb-4 p-2 border border-gray-300 rounded"></select>
    </div>
    <div id="plot"></div>
  </div>
  <script>
    let vizData = null;
    document.addEventListener('DOMContentLoaded', async () => {
      const response = await fetch('visualization_data.json');
      vizData = await response.json();
      const datasets = Object.keys(vizData.similarities).sort();
      const select = document.getElementById('dataset-select');
      datasets.forEach(ds => select.add(new Option(ds, ds)));
      select.addEventListener('change', () => updatePlot(select.value));
      updatePlot(datasets[0]);
    });

    function updatePlot(dataset) {
      const similarities = vizData.similarities[dataset] || [];
      const meanData = [];
      const singleAllData = [];
      similarities.forEach(sim => {
        if (sim.probe2 === "MEAN_PROBE") meanData.push({probe: sim.probe1, sim: sim.similarity});
        if (sim.probe2 === "SINGLE_ALL_PROBE") singleAllData.push({probe: sim.probe1, sim: sim.similarity});
      });

      const x = meanData.map(x => x.probe);
      const trace1 = {
        x: x,
        y: meanData.map(x => x.sim),
        type: 'bar',
        name: 'Similarity to Mean Probe',
        marker: { color: '#3b82f6' }
      };
      const trace2 = {
        x: x,
        y: singleAllData.map(x => x.sim),
        type: 'bar',
        name: 'Similarity to "Single All" Probe',
        marker: { color: '#f59e42' }
      };

      const layout = {
        barmode: 'group',
        xaxis: { title: 'Probe', tickangle: -40 },
        yaxis: { title: 'Cosine Similarity', range: [Math.min(0, ...meanData.map(d=>d.sim), ...singleAllData.map(d=>d.sim)), 1] },
        title: `Similarity Comparison for ${dataset}`,
        height: 500,
        legend: { orientation: "h", y: -0.2 }
      };

      Plotly.newPlot('plot', [trace1, trace2], layout, {responsive: true});
    }
  </script>
</body>
</html>
